<html>
    <head>
      <title>U5MR & GNI per capita</title>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js"></script>
      <link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
      <link href='https://fonts.googleapis.com/css?family=Slabo+27px' rel='stylesheet' type='text/css'>
      <style type="text/css">
          h1, p {
            font-family: 'Slabo 27px', serif;
          }
          .wrapper {
                 width: 900px;
                 margin: 40px auto 40px auto;
          }
          .axis path,
          .axis line {
            fill: none;
            stroke: black;
            shape-rendering: crispEdges;
          
          }

          circle {
            stroke: white;
          }

          circle:hover{
            opacity: 1;
          }

          .axis text {
            font-family: 'Open Sans', sans-serif;;
            font-size: 11px;
          }

      .tooltip {
        position: absolute;
        z-index: 10;
      }

      .tooltip p {
        background-color: rgba(211, 219, 222, 0.7 );
        box-shadow: 5px 5px 3px #DCDEDE;
        border: 0px;
        border-radius: 8px;
        padding: 2px;
        font-size: 12;
      }

      </style>
    </head>
    <body>
      <div class="wrapper">
       <h1>Under-5 Mortality Rate Declines with GNI per capita's increase</h1>
       <p>There is a very obvious relation between under-5 mortality rate (U5MR) per thousand births and their GNI per capita. The hignest the GNI per capita is, the lower the under-5 mortality rate is. The divergence for these two number around the world is quite huge. Norway has the highest GNI per capita, $102610. And its under-5 per thousand is only 3 per thousand births. In the same time, the highest U5MR country, Angola's GNI per capita is only $5010.  </p>
       <p><b>Source:</b><a href="http://www.worldvaluessurvey.org/WVSOnline.jsp">World Value Survey</a></p>
       <div id="svg"></div>
      
      </div><!-- wrapper -->
    </body>
    <script type="text/javascript">
            var fullWidth = 800;
            var fullHeight = 500;

            var margin = {top: 15, right: 60, bottom: 50, left: 80};

            var width =  fullWidth - margin.left - margin.right;
            var height = fullHeight - margin.top - margin.bottom;

            var dotRadius = 5;

            var xScale = d3.scale.linear()
                                 .range([margin.left, margin.left+width]);
            var yScale = d3.scale.linear()
                                 .range([margin.top+height, margin.top]);

            var xAxis = d3.svg.axis()
                              .scale(xScale)
                              .orient("bottom")
                              .ticks(10);
            var yAxis = d3.svg.axis()
                              .scale(yScale)
                              .orient("left");

            var svg = d3.select("#svg")
                        .append("svg")
                        .attr("width", fullWidth)
                        .attr("height", fullHeight);

            var tooltip = d3.select("body")
                            .append("div")
                            .attr("class", "tooltip");                        

            d3.csv("scatter_data.csv", function(data){
              xScale.domain(d3.extent(
                data, function(d){
                  return + d.Under5_mortality_rate;
                }));
              yScale.domain(d3.extent(
                data, function(d){
                  return + d.GNI_per_capita;
                }));

              var circles = svg.selectAll("circle")
                               .data(data)
                               .enter()
                               .append("circle")
                               .attr("class", "dots");
              circles.attr("cx", function(d){
                    return +xScale(d.Under5_mortality_rate);
              })
                     .attr("cy", function(d){
                      return +yScale(d.GNI_per_capita);
                     })
                     .attr("r", dotRadius)
                     .attr("fill", function(d){
                      if(d.countryName === "World"){
                        return "#FF9900"
                      }else{
                        return "#0099FF";
                      }})
                     .attr("opacity", "0.8");

              circles
                     .on("mouseover", mouseoverFunc) 
                     .on("mousemove", mousemoveFunc)
                     .on("mouseout", mouseoutFunc); 

              svg.append("g")
                 .attr("class", "x axis")
                 .attr("transform", "translate(0, "+(margin.top + height + 10)+ ")")
                 .call(xAxis);

              svg.append("g")
                 .attr("class", "y axis")
                 .attr("transform", "translate("+ (margin.left - 10)+", 0)")
                 .call(yAxis);

//x,y axis label:
               svg.append("text")
                   .attr("transform", "rotate(-90)")
                   .attr("y", margin.left/3 - 30)
                   .attr("x", 0 - fullHeight/3 - 20)
                   .attr("dy", "1em")
                   .style("text-anchor", "middle")
                   .text("GNI per capita")
                   .attr("font-family", "Open Sans")
                   .attr("font-size", "90%");

                svg.append("text")
                   .attr("transform", "translate(" + (fullWidth/2) + ", "+ (fullHeight-margin.bottom/2 + 20) + ")")
                   .style("text-anchor", "middle")
                   .text("Under-5 mortality rate per thousand births")
                   .attr("font-family", "Open Sans")
                   .attr("font-size", "90%");

            });

  function mouseoverFunc(d) {
    // console.log(d);
    return tooltip
      .style("display", null) // this removes the display none setting from it
      .html("<p>Country: " + d.countryName +
            "<br>Under-5 mortality rate: " + d.Under5_mortality_rate + 
            "<br>GNI per capita: $" + d.GNI_per_capita + "</p>");
    }

  function mousemoveFunc(d) {
    //console.log("events", window.event, d3.event);
    return tooltip
      .style("top", (d3.event.pageY - 10) + "px" )
      .style("left", (d3.event.pageX + 10) + "px");
  }

  function mouseoutFunc(d) {
    return tooltip.style("display", "none");  // this sets it to invisible!
  }

       </script>
</html>